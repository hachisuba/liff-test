<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>出勤一覧</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    body{font-family:system-ui,-apple-system,"Noto Sans JP",sans-serif;background:#f5f6f8;margin:0;padding:14px;}
    .wrap{max-width:560px;margin:0 auto;}
    .card{background:#fff;border-radius:16px;box-shadow:0 6px 24px rgba(0,0,0,.08);padding:18px;}
    h1{margin:6px 0 10px;text-align:center;font-size:26px;}
    .sub{text-align:center;color:#666;font-size:14px;margin-bottom:6px;}
    .pill{display:inline-block;background:#eef0f3;border-radius:999px;padding:6px 10px;font-size:14px;}
    .center{text-align:center;}
    .btnrow{display:flex;gap:10px;justify-content:center;margin:12px 0 10px;}
    .btn{border:0;border-radius:10px;padding:10px 16px;color:#fff;font-weight:700;font-size:15px;cursor:pointer;}
    .btn.blue{background:#1976d2;}
    .btn.green{background:#2e7d32;}
    .status{margin:10px 0 0;text-align:center;color:#444;font-size:14px;min-height:20px;}
    table{width:100%;border-collapse:collapse;margin-top:8px;}
    th,td{padding:10px 8px;border-bottom:1px solid #eee;font-size:15px;vertical-align:middle;}
    th{color:#666;font-weight:700;background:#fafafa;}
    .muted{color:#777;}
    .debug{display:none;margin-top:10px;background:#111;color:#e8e8e8;border-radius:12px;padding:10px;font-family:ui-monospace,SFMono-Regular,Menlo,monospace;font-size:12px;white-space:pre-wrap;word-break:break-all;}
    .spin{display:none;margin:8px auto 0;width:18px;height:18px;border-radius:50%;border:3px solid #ddd;border-top-color:#333;animation:rot .8s linear infinite;}
    @keyframes rot{to{transform:rotate(360deg)}}

    .btnSmall{border:0;border-radius:10px;padding:8px 10px;font-weight:800;font-size:13px;color:#fff;cursor:pointer;min-width:72px;}
    .btnRed{background:#d32f2f;}
    .btnDone{background:#2e7d32;}
    .btnGray{background:#bdbdbd; cursor:not-allowed;}

    .regBox{display:none;margin-top:14px;padding:12px;border-radius:14px;background:#fff5f5;border:1px solid #ffd3d3;}
    .regTitle{font-weight:900;color:#b71c1c;margin-bottom:8px;text-align:center;}
    .regRow{display:flex;gap:10px;align-items:center;justify-content:center;flex-wrap:wrap;}
    .regInput{width:220px;max-width:70vw;padding:10px 12px;border-radius:10px;border:1px solid #ddd;font-size:15px;}
    .regBtn{background:#d32f2f;color:#fff;border:0;border-radius:10px;padding:10px 14px;font-weight:900;cursor:pointer;}
    .regBtn:disabled{background:#bdbdbd;cursor:not-allowed;}
    .regHint{margin-top:8px;color:#666;font-size:13px;text-align:center;}

    .modalBg{display:none;position:fixed;inset:0;background:rgba(0,0,0,.4);align-items:center;justify-content:center;padding:18px;z-index:9999;}
    .modal{background:#fff;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.2);max-width:420px;width:100%;padding:16px;}
    .modalTitle{font-weight:900;font-size:16px;text-align:center;margin-bottom:8px;}
    .modalText{font-size:14px;color:#333;text-align:center;line-height:1.6;white-space:pre-line;}
    .modalBtns{display:flex;gap:10px;justify-content:center;margin-top:12px;}
    .mBtn{border:0;border-radius:10px;padding:10px 14px;font-weight:900;cursor:pointer;}
    .mBack{background:#e0e0e0;color:#333;}
    .mOk{background:#d32f2f;color:#fff;}
    .mOk:disabled{background:#bdbdbd;cursor:not-allowed;}

    /* ★追加：処理中オーバーレイ */
    .loadingOverlay{
      display:none;
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.35);
      z-index:10000;
      align-items:center;
      justify-content:center;
    }
    .loadingCard{
      background:#fff;
      border-radius:16px;
      padding:16px;
      width:260px;
      text-align:center;
      box-shadow:0 10px 30px rgba(0,0,0,.2);
    }
    .loadingSpinner{
      width:40px;height:40px;
      margin:0 auto 10px;
      border-radius:50%;
      border:5px solid #eee;
      border-top-color:#555;
      animation:rot .9s linear infinite;
    }
    .progressBar{
      width:100%;
      height:10px;
      background:#eee;
      border-radius:999px;
      overflow:hidden;
      margin-top:8px;
    }
    .progressFill{
      height:100%;
      width:0%;
      background:#555;
      transition:width .2s;
    }
    .progressText{
      font-size:12px;
      color:#666;
      margin-top:6px;
    }
  </style>
</head>
<body>

<!-- ★追加：処理中ポップアップ -->
<div class="loadingOverlay" id="loadingOverlay">
  <div class="loadingCard">
    <div class="loadingSpinner"></div>
    <div id="loadingMsg">処理中…</div>
    <div class="progressBar">
      <div class="progressFill" id="progressFill"></div>
    </div>
    <div class="progressText" id="progressText">0%</div>
  </div>
</div>

<div class="wrap">
  <!-- （中略：あなたのHTMLは一切変更なし） -->
</div>

<script>
  /* ===============================
     既存コードそのまま
  =============================== */

  // ★追加：進捗制御
  let progressTimer = null;
  function showOverlay(msg){
    document.getElementById("loadingMsg").textContent = msg || "処理中…";
    document.getElementById("progressFill").style.width = "0%";
    document.getElementById("progressText").textContent = "0%";
    document.getElementById("loadingOverlay").style.display = "flex";

    let p = 0;
    progressTimer = setInterval(()=>{
      p = Math.min(p + Math.random()*15, 90);
      document.getElementById("progressFill").style.width = p + "%";
      document.getElementById("progressText").textContent = Math.floor(p) + "%";
    }, 400);
  }

  function hideOverlay(){
    clearInterval(progressTimer);
    document.getElementById("progressFill").style.width = "100%";
    document.getElementById("progressText").textContent = "100%";
    setTimeout(()=>{
      document.getElementById("loadingOverlay").style.display = "none";
    }, 200);
  }

  // ★既存関数を拡張（呼び出し側は変更なし）
  function setLoading(on){
    if(on){
      showOverlay(elStatus.textContent || "処理中…");
    }else{
      hideOverlay();
    }
  }

</script>
</body>
</html>
