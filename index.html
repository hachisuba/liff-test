<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>出勤一覧</title></head>
<body>
<h2>本日の出勤一覧</h2>
<div id="list"></div>
<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbwqydPjkvk1bDvN4zlBxht64q5o-Grqe0O4oMG408zp09oFci9uB5-UG8qwiQf1vUEWEA/exec";

function apiJson(params) {
  return new Promise((resolve, reject) => {
    const cbName = "cb" + Date.now() + Math.floor(Math.random()*1000);

    window[cbName] = (data) => {
      delete window[cbName];
      script.remove();
      resolve(data);
    };

    const qs = new URLSearchParams();
    Object.entries(params).forEach(([k,v]) => qs.append(k, v));
    qs.append("callback", cbName);
    qs.append("cb", String(Date.now()));

    const script = document.createElement("script");
    script.src = GAS_URL + "?" + qs.toString();
    script.onerror = () => {
      delete window[cbName];
      script.remove();
      reject(new Error("JSONP通信失敗"));
    };

    document.body.appendChild(script);
  });
}
</script>
